# Predictable token
GUIDs (often called UUIDs) are widely used in modern web applications. One common use for UUIDs is the generation of one-time-use tokens. These can used for password reset, and e-mail confirmation routines, for example.

There are five versions of UUIDs defined in RFC 4122. Out of the five, four are generated in a predictable manner. This means it is possible for someone to predict future UUIDs based on a sample generated by the target application.

Version four is the only UUID version expected to be randomly generated. Therefore, for situations where predictable tokens are not desired (e.g. password reset tokens), all other versions should be avoided.


## Recommendation
When using GUIDs/UUIDs for generating tokens that should not be predictable, use version four.


## Example
This example shows a UUID v1 being used for a password reset routine.


```javascript
var uuid = require('uuid');

module.exports = function (app) {

    app.use('/login', function (req, res) {

        var username = req.body.username;
        var password = req.body.password;

        if (!username) {
            res.status(400);
            return;
        }

        if (!password) {
            res.status(400);
            return;
        }

        var newToken = {
            userId: user._id,
            token: uuid.v1(),
            created: new Date(),
        };

        res.status(200).json({
            token: newToken.token
        });
    });
};
```

## References
* UUID [RFC](https://datatracker.ietf.org/doc/html/rfc4122).
* Daniel Thatcher *In GUID We Trust* [article](https://www.intruder.io/research/in-guid-we-trust).
* UUID exploitation [tool](https://github.com/intruder-io/guidtool).
* Common Weakness Enumeration: [CWE-340](https://cwe.mitre.org/data/definitions/340.html).
